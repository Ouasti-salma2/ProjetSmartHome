<div class="dashboard-container">
  <!-- Header avec bouton dÃ©connexion -->
  <div class="header">
    <div class="logo">
      <h1>ğŸ  Smart Home</h1>
    </div>
    <div class="user-info">
      <span class="welcome">Bonjour, {{ user?.name || user?.email }}</span>
      <button class="btn-logout" (click)="logout()">
        ğŸ”“ DÃ©connexion
      </button>
    </div>
  </div>

  <!-- Contenu principal -->
  <div class="content">

    <!-- Message d'erreur -->
    <div *ngIf="errorMessage" class="alert alert-error">
      {{ errorMessage }}
    </div>

    <!-- Header de la section de equepement -->
    <div class="devices-header">
      <h2>ğŸ“± Mes Ã‰quipements</h2>
      <button class="btn-add" (click)="showCreateForm = !showCreateForm">
        {{ showCreateForm ? 'âŒ Annuler' : 'â• Ajouter un Ã©quipement' }}
      </button>
    </div>

    <!-- Formulaire de crÃ©ation  equpement-->
    <div *ngIf="showCreateForm" class="create-form">
      <h3>Nouvel Ã©quipement</h3>
      <div class="form-row">
        <div class="form-group">
          <label>Nom</label>
          <input
            type="text"
            [(ngModel)]="newDevice.name"
            placeholder="Ex: LumiÃ¨re salon"
            class="input">
        </div>
        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="newDevice.type" class="input">
            <option value="Light">ğŸ’¡ LumiÃ¨re</option>
            <option value="Temperature">ğŸŒ¡ï¸ Thermostat</option>
            <option value="Lock">ğŸ”’ Serrure</option>
            <option value="Camera">ğŸ“· CamÃ©ra</option>
            <option value="Alarm">ğŸš¨ Alarme</option>
          </select>
        </div>
        <div class="form-group">
          <label>Localisation</label>
          <input
            type="text"
            [(ngModel)]="newDevice.location"
            placeholder="Ex: Salon"
            class="input">
        </div>
        <button class="btn-create" (click)="createDevice()">
          âœ… CrÃ©er
        </button>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <p>Chargement des Ã©quipements...</p>
    </div>

    <!-- Liste des des equipement -->
    <div *ngIf="!isLoading && devices.length > 0" class="devices-grid">
      <div *ngFor="let device of devices" class="device-card">

        <!-- Header de la card -->
        <div class="device-header">
          <div class="device-icon">
            <span *ngIf="device.type === 'Light'">ğŸ’¡</span>
            <span *ngIf="device.type === 'Temperature'">ğŸŒ¡ï¸</span>
            <span *ngIf="device.type === 'Lock'">ğŸ”’</span>
            <span *ngIf="device.type === 'Camera'">ğŸ“·</span>
            <span *ngIf="device.type === 'Alarm'">ğŸš¨</span>
          </div>
          <button class="btn-delete" (click)="deleteDevice(device.id)" title="Supprimer">
            ğŸ—‘ï¸
          </button>
        </div>

        <!-- Infos du equipement -->
        <div class="device-info">
          <h3>{{ device.name }}</h3>
          <p class="device-location">ğŸ“ {{ device.location }}</p>
          <p class="device-type">{{ device.type }}</p>
        </div>

        <!-- Status et Toggle -->
        <div class="device-footer">
          <span
            class="status-badge"
            [class.active]="device.isActive"
            [class.inactive]="!device.isActive">
            {{ device.isActive ? 'âœ… ON' : 'â­• OFF' }}
          </span>
          <button
            class="btn-toggle"
            [class.btn-on]="device.isActive"
            [class.btn-off]="!device.isActive"
            (click)="toggleDevice(device)">
            {{ device.isActive ? 'ğŸ”´ Ã‰teindre' : 'ğŸŸ¢ Allumer' }}
          </button>
        </div>

        <!-- TempÃ©rature si applicable -->
        <div *ngIf="device.temperature" class="device-temp">
          ğŸŒ¡ï¸ {{ device.temperature }}Â°C
        </div>
      </div>
    </div>

    <!-- Message si aucun equipement -->
    <div *ngIf="!isLoading && devices.length === 0" class="no-devices">
      <div class="empty-icon">ğŸ“¦</div>
      <h3>Aucun Ã©quipement</h3>
      <p>Ajoutez votre premier Ã©quipement pour commencer !</p>
      <button class="btn-add-first" (click)="showCreateForm = true">
        â• Ajouter mon premier Ã©quipement
      </button>
      <p class="register-link" style="text-align: center; margin-top: 20px; color: #666;">
        Pas de compte ?
        <a routerLink="/register" style="color: #667eea; text-decoration: none; font-weight: 600;">
          S'inscrire
        </a>
      </p>
    </div>

  </div>
</div>
